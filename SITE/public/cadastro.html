<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Landing page</title>
    <link rel="stylesheet" href="./CSS/cadastro.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- site de icones -->
</head>
<body>
    <header>
        <div id="tittle">
            <h1>Literacia</h1>
            <h1>Conectada</h1>
        </div>
        <ul class="linkLogin">
            <li><a href="index.html">Início</a></li>
            <li><a href="sobre.html">Sobre</a></li>
            <li><a href="cadastro.html">Cadastro</a></li>
            <li><a href="login.html" id="login-link">Já tem uma conta?</a></li>
        </ul>
    </header>

    <main>
        <aside>  
            <!-- tag semantica que define uma pagina que tenha um lado -->
            <h2 style="margin-left: 60px;"><span>Cadastre-se agora</span></h2>
            <h2 style="margin-left: 60px;">na Literacia</h2>
            <p style="color: #c8c5c5; margin-left: 80px;"  >Increva-se agora na Literacia e dê o primeiro passo rumo a uma jornada de <span style="color: #dfbe06;">descobertas</span> intelectuais e <span style="color: #FFD700;">crescimento pessoal.</span> <br>
            O saber transforma, e a Literacia está aqui para guiar você nessa fascinante <span style="color:  #FFD700;">jornada.</span>  <br> Inscreva-se agora e desbloqueie um universo de possibilidades educacionais</p>
        </aside>

        <article>
            <!-- tag semantica para abrigar imagens -->
            <!-- <form>  -->
            
                <div id="msgError"></div>
                <div id="msgSuccess"></div>

                <div class='card' >
                    <h1 class="tituloCard"> cadastro </h1>
                    <div class='label-float'>
                      <input type='text' id='nome' placeholder='' required>
                      <label for='nome' id="labelNome">Nome</label>
                    </div>
              
                    <div class='label-float'>
                        <input type='text' id='usuario' placeholder='' required>
                        <label for='usuario' id="labelUsuario">Usuário</label>
                    </div>

                    <div class='label-float'>
                        <input type='email' id='email' placeholder='' required>
                        <label for='email' id="labelEmail">E-mail</label>
                    </div>

                    <div class='label-float'>
                        <input type='email' id='confirmarEmail' placeholder='' required>
                        <label for='confirmarEmail' id="labelConfirmarEmail">Confirmar e-mail</label>
                    </div>
                    
                    <div class='label-float'>
                        <input type='password' id='senha' placeholder='' required>
                        <label for='senha' id="labelSenha">senha</label>
                        <i id= 'verSenha' class="fa fa-eye" aria-hidden="true"></i>
                    </div>
          
                    <div class='label-float'>
                        <input type='text' id='confirmarSenha' placeholder='' required>
                        <label for='confirmarSenha' id="labelConfirmarSenha">Confirmar Senha</label>
                        <i id= 'verConfirmarSenha' class="fa fa-eye" aria-hidden="true"></i>
                    </div>
          
                        <div class="justify-center">
                            <input type="submit" value="Cadastrar" onclick="cadastrar()">
                        </div>
                      
                      <p style="margin-left: 65px; font-size: 16px">Já possui uma conta? Faça o
                          <a href="login.html" class="linkLogin" style="color: black;">login</a>
                      </p>
                  </div>
            <!-- tag semantica para campos de pesquisa -->
            <!-- </form> -->
        </article>
    </main>
   
</body>
</html>

  <script>
var btn = document.querySelector('#verSenha');
    /*minha variavel btn esta acessando o documento e através do querySelector eu vou procurar a minha class, logo em seguida adicionei minha class a minha variavel*/
var btnConfirm = document.querySelector('#verConfirmarSenha');

var nome= document.querySelector('#nome');
var labelNome= document.querySelector('#labelNome');

var apelido= document.querySelector('#usuario');
var labelApelido= document.querySelector('#labelUsuario');

var senha= document.querySelector('#senha');
var labelSenha= document.querySelector('#labelSenha');

var confirmarSenha= document.querySelector('#confirmarSenha');
var labelConfirmarSenha= document.querySelector('#labelConfirmarSenha');

var email= document.querySelector('#email');
var labelEmail= document.querySelector('#labelEmail');

var confirmarEmail= document.querySelector('#confirmarEmail');
var labelConfirmarEmail = document.querySelector('#labelConfirmarEmail');

var validNome = false;
var validApelido = false;
var validSenha = false;
var validConfirme = false;
var validEmail = false;
var validConfirmarEmail = false;
    // false = formulario nao preenchido

var msgError = document.querySelector('#msgError')
var msgSuccess = document.querySelector('#msgSuccess')

// estou criando uma função e adicionando um evento keyup, ao digitar e tirar o dedo da tecla, ele começa a fazer o que estiver na minha eron function
nome.addEventListener('keyup', () => {
    if(nome.value.length <= 2){
        labelNome.setAttribute('style', 'color: red')
        labelNome.innerHTML = 'Nome *Insira no mínimo 3 caracteres'
        nome.setAttribute('style', 'border-color: red')
        validNome = false
    }else{
        labelNome.setAttribute('style', 'color: green')
        labelNome.innerHTML = 'Nome'
        nome.setAttribute('style', 'border-color: green')  
        validNome = true
    }
})
 
apelido.addEventListener('keyup', () => { 
    if(usuario.value.length <= 4){
        labelApelido.setAttribute('style', 'color: red')
        labelApelido.innerHTML = 'Usuário *Insira no mínimo 5 caracteres'
        apelido.setAttribute('style', 'border-color: red')
        validApelido = false
    }else{
        labelApelido.setAttribute('style', 'color: green')
        labelApelido.innerHTML = 'Usuário'
        apelido.setAttribute('style', 'border-color: green')
        validApelido = true
    }
})

senha.addEventListener('keyup', () => { 
    if(senha.value.length <= 7){
        labelSenha.setAttribute('style', 'color: red')
        labelSenha.innerHTML = 'Senha *Insira no mínimo 8 caracteres'
        senha.setAttribute('style', 'border-color: red')
        validSenha = false
    }else{
        labelSenha.setAttribute('style', 'color: green')
        labelSenha.innerHTML = 'Senha'
        senha.setAttribute('style', 'border-color: green')
        validSenha = true
    }
})

confirmarSenha.addEventListener('keyup', () => { 
    if(senha.value != confirmarSenha.value){
        labelConfirmarSenha.setAttribute('style', 'color: red')
        labelConfirmarSenha.innerHTML = 'Confirmar Senha *As senhas não conferem'
        confirmarSenha.setAttribute('style', 'border-color: red')
        validConfirme = false
    }else{
        labelConfirmarSenha.setAttribute('style', 'color: green')
        labelConfirmarSenha.innerHTML = 'Confirmar Senha'
        confirmarSenha.setAttribute('style', 'border-color: green')
        validConfirme = true
    }
})

email.addEventListener('keyup', () => { 
    if(email.value.endsWith(`.com`) == false){
        labelEmail.setAttribute('style', 'color: red')
        labelEmail.innerHTML = 'E-mail *incorreto'
        email.setAttribute('style', 'border-color: red')
        validEmail = false
    }else{
        labelEmail.setAttribute('style', 'color: green')
        labelEmail.innerHTML = 'E-mail'
        email.setAttribute('style', 'border-color: green')
        validEmail = true
    }
})

confirmarEmail.addEventListener('keyup', () => { 
    if(confirmarEmail.value != email.value){
        labelConfirmarEmail.setAttribute('style', 'color: red')
        labelConfirmarEmail.innerHTML = 'Confirmar E-mail *Os e-mails não conferem'
        confirmarEmail.setAttribute('style', 'border-color: red')
        validConfirmarEmail = false
    }else{
        labelConfirmarEmail.setAttribute('style', 'color: green')
        labelConfirmarEmail.innerHTML = 'Confirmar E-mail'
        confirmarEmail.setAttribute('style', 'border-color: green')
        validConfirmarEmail = true
    }
})


btn.addEventListener('click', ()=>{
    let inputSenha = document.querySelector('#senha')
    
    if(inputSenha.getAttribute('type') == 'password'){
     inputSenha.setAttribute('type', 'text')

    } else {
     inputSenha.setAttribute('type', 'password')
    }

})
    /*inserir um evento que logo em seguida acontecerá algo */
btnConfirm.addEventListener('click', ()=>{
    let inputConfirmSenha = document.querySelector('#confirmarSenha')
    
    if(inputConfirmSenha.getAttribute('type') == 'password'){
     inputConfirmSenha.setAttribute('type', 'text')

    } else {
     inputConfirmSenha.setAttribute('type', 'password')
    }
})
</script>


<script>
    function cadastrar() {
  
      //Recupere o valor da nova input pelo nome do id
      // Agora vá para o método fetch logo abaixo
      var nomeVar = nome.value;
      var apelidoVar = apelido.value;
      var emailVar = email.value;
      var senhaVar = senha.value;
      if (
        nomeVar == "" ||
        emailVar == "" ||
        senhaVar == "" ||
        apelidoVar == "" 
      ) {
        cardErro.style.display = "block";
        mensagem_erro.innerHTML =
          "(Mensagem de erro para todos os campos em branco)";
  
        return false;
    }
      // Enviando o valor da nova input
      fetch("/usuarios/cadastrar", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          // crie um atributo que recebe o valor recuperado aqui
          // Agora vá para o arquivo routes/usuario.js
          nomeServer: nomeVar,
          emailServer: emailVar,
          senhaServer: senhaVar,
          apelidoServer: apelidoVar
          ,
        }),
      })
        .then(function (resposta) {
          console.log("resposta: ", resposta);
  
          if (resposta.ok) {

            console.log("DENTRO DO IF DO CADASTRAR")
            // cardErro.style.display = "block";
  
            // mensagem_erro.innerHTML =
            //   "Cadastro realizado com sucesso! Redirecionando para tela de Login...";
  
            setTimeout(() => {
              window.location = "login.html";
            }, "3000");
  
          } else {
            throw "Houve um erro ao tentar realizar o cadastro!";
          }
        })
        .catch(function (resposta) {
          console.log(`#ERRO: ${resposta}`);
        });
  
      return false;
    }

    function sumirMensagem() {
      cardErro.style.display = "none";
    }
  </script>